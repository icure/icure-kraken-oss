
	<link rel="import" href="../../../bower_components/polymer/polymer.html">
	<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">

	<dom-module id="icc-hcparty-api">
		<template>
    		<style>
	    	</style>
				<iron-ajax id="createHealthcareParty" method="POST" headers="[[headers]]" url="/hcparty" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="createHealthcarePartySignUp" method="POST" headers="[[headers]]" url="/hcparty/signup" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="createTemplateReplication" method="POST" headers="[[headers]]" url="/hcparty/replication/template/{replicationHost}/{language}/{specialtyCode}" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="deleteHealthcareParties" method="DELETE" headers="[[headers]]" url="/hcparty/{healthcarePartyIds}" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="findByName" method="GET" headers="[[headers]]" url="/hcparty/byName" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="findBySpecialityAndPostCode" method="GET" headers="[[headers]]" url="/hcparty/bySpecialityAndPostCode/{type}/{spec}/{firstCode}/to/{lastCode}" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="getCurrentHealthcareParty" method="GET" headers="[[headers]]" url="/hcparty/current" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="getHcPartyKeysForDelegate" method="GET" headers="[[headers]]" url="/hcparty/{healthcarePartyId}/keys" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="getHealthcareParties" method="GET" headers="[[headers]]" url="/hcparty/byIds/{healthcarePartyIds}" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="getHealthcareParty" method="GET" headers="[[headers]]" url="/hcparty/{healthcarePartyId}" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="getPublicKey" method="GET" headers="[[headers]]" url="/hcparty/{healthcarePartyId}/publicKey" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="listByName" method="GET" headers="[[headers]]" url="/hcparty/byNameStrict/{name}" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="listHealthcareParties" method="GET" headers="[[headers]]" url="/hcparty" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="modifyHealthcareParty" method="PUT" headers="[[headers]]" url="/hcparty" handle-as="json" on-error="handleError" with-credentials></iron-ajax>
		</template>
	</dom-module>

	<script>
		(function () {
			Polymer({
				is: 'icc-hcparty-api',
				properties: {
					headers: {
						type: Object,
						value: {"Content-Type": "application/json"}
					},
					host: {
						type: String
					}
				},
				behaviors: [],
				createHealthcareParty: function (body) {
					var xhr = this.$.createHealthcareParty
					xhr.body = body
					xhr.url = this.host+"/hcparty" + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				createHealthcarePartySignUp: function (body) {
					var xhr = this.$.createHealthcarePartySignUp
					xhr.body = body
					xhr.url = this.host+"/hcparty/signup" + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				createTemplateReplication: function (replicationHost, language, specialtyCode, protocol, port) {
					var xhr = this.$.createTemplateReplication

					xhr.url = this.host+"/hcparty/replication/template/{replicationHost}/{language}/{specialtyCode}".replace("{replicationHost}", replicationHost).replace("{language}", language).replace("{specialtyCode}", specialtyCode) + "?ts=" + (new Date).getTime()  + (protocol ? "&protocol=" + protocol : "") + (port ? "&port=" + port : "")
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				deleteHealthcareParties: function (healthcarePartyIds) {
					var xhr = this.$.deleteHealthcareParties

					xhr.url = this.host+"/hcparty/{healthcarePartyIds}".replace("{healthcarePartyIds}", healthcarePartyIds) + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				findByName: function (name, startKey, startDocumentId, limit, desc) {
					var xhr = this.$.findByName

					xhr.url = this.host+"/hcparty/byName" + "?ts=" + (new Date).getTime()  + (name ? "&name=" + name : "") + (startKey ? "&startKey=" + startKey : "") + (startDocumentId ? "&startDocumentId=" + startDocumentId : "") + (limit ? "&limit=" + limit : "") + (desc ? "&desc=" + desc : "")
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				findBySpecialityAndPostCode: function (type, spec, firstCode, lastCode, limit) {
					var xhr = this.$.findBySpecialityAndPostCode

					xhr.url = this.host+"/hcparty/bySpecialityAndPostCode/{type}/{spec}/{firstCode}/to/{lastCode}" + "?ts=" + (new Date).getTime()  + (type ? "&type=" + type : "") + (spec ? "&spec=" + spec : "") + (firstCode ? "&firstCode=" + firstCode : "") + (lastCode ? "&lastCode=" + lastCode : "") + (limit ? "&limit=" + limit : "")
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				getCurrentHealthcareParty: function () {
					var xhr = this.$.getCurrentHealthcareParty

					xhr.url = this.host+"/hcparty/current" + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				getHcPartyKeysForDelegate: function (healthcarePartyId) {
					var xhr = this.$.getHcPartyKeysForDelegate

					xhr.url = this.host+"/hcparty/{healthcarePartyId}/keys".replace("{healthcarePartyId}", healthcarePartyId) + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				getHealthcareParties: function (healthcarePartyIds) {
					var xhr = this.$.getHealthcareParties

					xhr.url = this.host+"/hcparty/byIds/{healthcarePartyIds}".replace("{healthcarePartyIds}", healthcarePartyIds) + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				getHealthcareParty: function (healthcarePartyId) {
					var xhr = this.$.getHealthcareParty

					xhr.url = this.host+"/hcparty/{healthcarePartyId}".replace("{healthcarePartyId}", healthcarePartyId) + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				getPublicKey: function (healthcarePartyId) {
					var xhr = this.$.getPublicKey

					xhr.url = this.host+"/hcparty/{healthcarePartyId}/publicKey".replace("{healthcarePartyId}", healthcarePartyId) + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				listByName: function (name) {
					var xhr = this.$.listByName

					xhr.url = this.host+"/hcparty/byNameStrict/{name}".replace("{name}", name) + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				listHealthcareParties: function (startKey, startDocumentId, limit, desc) {
					var xhr = this.$.listHealthcareParties

					xhr.url = this.host+"/hcparty" + "?ts=" + (new Date).getTime()  + (startKey ? "&startKey=" + startKey : "") + (startDocumentId ? "&startDocumentId=" + startDocumentId : "") + (limit ? "&limit=" + limit : "") + (desc ? "&desc=" + desc : "")
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				modifyHealthcareParty: function (body) {
					var xhr = this.$.modifyHealthcareParty
					xhr.body = body
					xhr.url = this.host+"/hcparty" + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				handleError: function (e) {
					if (e.detail.request.status === 401) this.fire('auth-failed')
					else this.fire('api-error', e)
				}
			});
		})();
	</script>

@end
