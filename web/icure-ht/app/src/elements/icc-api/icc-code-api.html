
	<link rel="import" href="../../../bower_components/polymer/polymer.html">
	<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">

	<dom-module id="icc-code-api">
		<template>
    		<style>
	    	</style>

				<iron-ajax id="createCode" method="POST" headers="[[headers]]" url="/code" handle-as="json"
									 on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="findCodeTypes" method="GET" headers="[[headers]]" url="/code/codetype/byRegionType" handle-as="json"
									 on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="findCodes" method="GET" headers="[[headers]]" url="/code/byRegionTypeCode" handle-as="json"
									 on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="findPaginatedCodes" method="GET" headers="[[headers]]" url="/code" handle-as="json"
									 on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="findPaginatedCodesByLabel" method="GET" headers="[[headers]]" url="/code/byLabel" handle-as="json"
									 on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="findTagTypes" method="GET" headers="[[headers]]" url="/code/tagtype/byRegionType" handle-as="json"
									 on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="getCode" method="GET" headers="[[headers]]" url="/code/{codeId}" handle-as="json"
									 on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="getCodeWithParts" method="GET" headers="[[headers]]" url="/code/{type}/{code}/{version}" handle-as="json"
									 on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="getCodes" method="GET" headers="[[headers]]" url="/code/byIds/{codeIds}" handle-as="json"
									 on-error="handleError" with-credentials></iron-ajax>
				<iron-ajax id="modifyCode" method="PUT" headers="[[headers]]" url="/code" handle-as="json"
									 on-error="handleError" with-credentials></iron-ajax>
		</template>
	</dom-module>

	<script>
		(function () {
			Polymer({
				is: 'icc-code-api',
				properties: {
					headers: {
						type: Object,
						value: {"Content-Type": "application/json"}
					},
					host: {
						type: String
					}
				},
				behaviors: [],
				createCode: function (body) {
					var xhr = this.$.createCode
					xhr.body = body
					xhr.url = this.host+"/code" + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				findCodeTypes: function (region, type) {
					var xhr = this.$.findCodeTypes

					xhr.url = this.host+"/code/codetype/byRegionType" + "?ts=" + (new Date).getTime()  + (region ? "&region=" + region : "") + (type ? "&type=" + type : "")
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				findCodes: function (region, type, code, version) {
					var xhr = this.$.findCodes

					xhr.url = this.host+"/code/byRegionTypeCode" + "?ts=" + (new Date).getTime()  + (region ? "&region=" + region : "") + (type ? "&type=" + type : "") + (code ? "&code=" + code : "") + (version ? "&version=" + version : "")
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				findPaginatedCodes: function (region, type, code, version, startDocumentId, limit) {
					var xhr = this.$.findPaginatedCodes

					xhr.url = this.host+"/code" + "?ts=" + (new Date).getTime()  + (region ? "&region=" + region : "") + (type ? "&type=" + type : "") + (code ? "&code=" + code : "") + (version ? "&version=" + version : "") + (startDocumentId ? "&startDocumentId=" + startDocumentId : "") + (limit ? "&limit=" + limit : "")
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				findPaginatedCodesByLabel: function (region, types, language, label, startDocumentId, limit) {
					var xhr = this.$.findPaginatedCodesByLabel

					xhr.url = this.host+"/code/byLabel" + "?ts=" + (new Date).getTime()  + (region ? "&region=" + region : "") + (types ? "&types=" + types : "") + (language ? "&language=" + language : "") + (label ? "&label=" + label : "") + (startDocumentId ? "&startDocumentId=" + startDocumentId : "") + (limit ? "&limit=" + limit : "")
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				findTagTypes: function (region, type) {
					var xhr = this.$.findTagTypes

					xhr.url = this.host+"/code/tagtype/byRegionType" + "?ts=" + (new Date).getTime()  + (region ? "&region=" + region : "") + (type ? "&type=" + type : "")
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				getCode: function (codeId) {
					var xhr = this.$.getCode

					xhr.url = this.host+"/code/{codeId}".replace("{codeId}", codeId) + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				getCodeWithParts: function (type, code, version) {
					var xhr = this.$.getCodeWithParts

					xhr.url = this.host+"/code/{type}/{code}/{version}".replace("{type}", type).replace("{code}", code).replace("{version}", version) + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				getCodes: function (codeIds) {
					var xhr = this.$.getCodes

					xhr.url = this.host+"/code/byIds/{codeIds}".replace("{codeIds}", codeIds) + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				modifyCode: function (body) {
					var xhr = this.$.modifyCode
					xhr.body = body
					xhr.url = this.host+"/code" + "?ts=" + (new Date).getTime()
					return xhr.generateRequest().completes.then(function (req) {
						return req.response
					})
				},
				handleError: function (e) {
					if (e.detail.request.status === 401) this.fire('auth-failed')
					else this.fire('api-error', e)
				}
			});
		})();
	</script>

@end
